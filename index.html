<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>Decompo Planter</title>
    <script src="https://cdnjs.cloudflare.com"></script>
    <style>
        body { margin: 0; background: #020508; overflow: hidden; font-family: sans-serif; color: #fff; }
        #p5-container { width: 100%; height: 600px; }
    </style>
</head>
<body>
    <div id="p5-container"></div>
    <script>
        let items = [];
        let decomposers = [];
        let carbon = 0, nitrogen = 0, humidity = 1.0;
        let isPolluted = false;

        class Decomposer {
            constructor(type) {
                this.pos = createVector(random(-200, 200), random(-200, 200));
                this.type = type;
            }
            update() { this.pos.add(p5.Vector.random2D().mult(0.5)); }
            display() {
                fill(100, 200, 100);
                noStroke();
                ellipse(this.pos.x, this.pos.y, 5, 5);
            }
        }

        class OrganicMatter {
            constructor(x, y, type) {
                this.pos = createVector(x, y);
                this.type = type;
                this.life = 255;
            }
            update() { this.life -= 1; }
            display() {
                fill(200, 150, 100, this.life);
                rect(this.pos.x, this.pos.y, 10, 10);
            }
            isDead() { return this.life <= 0; }
        }

        function setup() {
            let container = document.getElementById('p5-container');
            createCanvas(container.offsetWidth, 600).parent('p5-container');
            for (let i = 0; i < 10; i++) decomposers.push(new Decomposer('bacteria'));
        }

        function draw() {
            background(2, 5, 10);
            translate(width / 2, height / 2);
            for (let i = items.length - 1; i >= 0; i--) {
                items[i].update();
                items[i].display();
                if (items[i].isDead()) items.splice(i, 1);
            }
            decomposers.forEach(d => {
                d.update();
                d.display();
            });
            resetMatrix();
            fill(255);
            text(`Carbon: ${carbon}  Humidity: ${humidity.toFixed(2)}`, 20, 30);
        }

        function mousePressed() {
            items.push(new OrganicMatter(mouseX - width/2, mouseY - height/2, 'leaf'));
        }
    </script>
</body>
</html>
